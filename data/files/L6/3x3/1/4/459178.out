Job running on nodes: jean-zay-iam47
recursion  started at Sat Nov  2 12:11:21 AM CET 2024
python -u -O /lustre/fswork/projects/rech/iqu/uvm91ap/repos/netket_pro_nocallback/deepnets/optimization/run.py --L=6 --J 0.8 1.0 --n_blocks 8 --features 72 --expansion_factor=2 --downsample_factor=2 --kernel_width=3 --output_head=Vanilla --samples_per_rank=512 --chains_per_rank=512 --discard_fraction=0.0 --iters 2500 2500 2500 2500 --lr 0.01 0.01 0.01 0.01 --alpha 0.5 0.5 0.5 0.5 --diag_shift 0.01 0.01 0.01 0.01 --diag_shift_end 0.0001 0.0001 0.0001 0.0001 --r=1e-06 --chunk_size=256 --save_every=100 --symmetries=0 --symmetry_ramping=1 --momentum=0.9 --post_iters=50 --double_precision=1 --time_it=0 --show_progress=0 --checkpoint=1 --seed=76  --save_base /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/ >> /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/${SLURM_JOB_ID}.out &
Configuring sharding...
Number of distributed processes = 1
Number of total devices: 8
0/1 : global [CudaDevice(id=0), CudaDevice(id=1), CudaDevice(id=2), CudaDevice(id=3), CudaDevice(id=4), CudaDevice(id=5), CudaDevice(id=6), CudaDevice(id=7)]
0/1 : local [CudaDevice(id=0), CudaDevice(id=1), CudaDevice(id=2), CudaDevice(id=3), CudaDevice(id=4), CudaDevice(id=5), CudaDevice(id=6), CudaDevice(id=7)]
0/1 : hostname:  jean-zay-iam47
Double precision enabled =  True
chunk_size = 256
Running optimization...
Symmetry stage 0 on process 0:
Total number of model parameters = 188136
Using minSR
restoring checkpoint #2500
restoring checkpoint #2500
Symmetry stage 1 on process 0:
Total number of model parameters = 188136
Using minSR
restoring checkpoint #2500
Symmetry stage 2 on process 0:
Total number of model parameters = 188136
Using minSR
restoring checkpoint #2500
Symmetry stage 3 on process 0:
Total number of model parameters = 188136
Using minSR
restoring checkpoint #2500
Finished optimization
Performing 50 additional optimization steps...
Sampling parameters:
n_chains = 256
n_samples = 4096
n_samples_per_chain = 16
n_discard_per_chain = 16
restoring checkpoint #29
  0%|          | 0/50 [00:00<?, ?it/s]  0%|          | 0/50 [00:56<?, ?it/s, Energy=-65.0528-0.0000j ± 0.0053 [σ²=0.1126, R̂=1.0314]] 58%|█████▊    | 29/50 [00:56<00:41,  1.96s/it, Energy=-65.0528-0.0000j ± 0.0053 [σ²=0.1126, R̂=1.0314]] 58%|█████▊    | 29/50 [01:44<00:41,  1.96s/it, Energy=-65.0528-0.0000j ± 0.0053 [σ²=0.1126, R̂=1.0314]] 58%|█████▊    | 29/50 [01:10<00:41,  1.96s/it, Energy=-65.0418+0.0004j ± 0.0047 [σ²=0.0807, R̂=1.0348]] 60%|██████    | 30/50 [01:10<00:50,  2.51s/it, Energy=-65.0418+0.0004j ± 0.0047 [σ²=0.0807, R̂=1.0348]]WARNING:absl:[process=0][thread=async_save_6] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/30.orbax-checkpoint-tmp-0/loggers.orbax-checkpoint-tmp-4, 
 60%|██████    | 30/50 [01:23<00:50,  2.51s/it, Energy=-65.0493+0.0011j ± 0.0038 [σ²=0.0644, R̂=1.0292]] 62%|██████▏   | 31/50 [01:23<01:00,  3.17s/it, Energy=-65.0493+0.0011j ± 0.0038 [σ²=0.0644, R̂=1.0292]]WARNING:absl:[process=0][thread=async_save_7] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/31.orbax-checkpoint-tmp-8/loggers.orbax-checkpoint-tmp-12, 
 62%|██████▏   | 31/50 [01:36<01:00,  3.17s/it, Energy=-65.0510+0.0001j ± 0.0046 [σ²=0.0805, R̂=1.0310]] 64%|██████▍   | 32/50 [01:36<01:11,  3.97s/it, Energy=-65.0510+0.0001j ± 0.0046 [σ²=0.0805, R̂=1.0310]]WARNING:absl:[process=0][thread=async_save_8] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/32.orbax-checkpoint-tmp-16/loggers.orbax-checkpoint-tmp-20, 
 64%|██████▍   | 32/50 [01:49<01:11,  3.97s/it, Energy=-65.0437+0.0001j ± 0.0037 [σ²=0.0620, R̂=1.0285]] 66%|██████▌   | 33/50 [01:49<01:23,  4.92s/it, Energy=-65.0437+0.0001j ± 0.0037 [σ²=0.0620, R̂=1.0285]]WARNING:absl:[process=0][thread=async_save_9] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/33.orbax-checkpoint-tmp-24/loggers.orbax-checkpoint-tmp-28, 
 66%|██████▌   | 33/50 [02:02<01:23,  4.92s/it, Energy=-65.0467+0.0002j ± 0.0037 [σ²=0.0569, R̂=1.0287]] 68%|██████▊   | 34/50 [02:02<01:35,  5.96s/it, Energy=-65.0467+0.0002j ± 0.0037 [σ²=0.0569, R̂=1.0287]]WARNING:absl:[process=0][thread=async_save_10] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/34.orbax-checkpoint-tmp-32/loggers.orbax-checkpoint-tmp-36, 
 68%|██████▊   | 34/50 [02:15<01:35,  5.96s/it, Energy=-65.0547+0.0002j ± 0.0072 [σ²=0.2361, R̂=1.0267]] 70%|███████   | 35/50 [02:15<01:45,  7.06s/it, Energy=-65.0547+0.0002j ± 0.0072 [σ²=0.2361, R̂=1.0267]]WARNING:absl:[process=0][thread=async_save_11] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/35.orbax-checkpoint-tmp-40/loggers.orbax-checkpoint-tmp-44, 
 70%|███████   | 35/50 [02:28<01:45,  7.06s/it, Energy=-65.0517-0.0001j ± 0.0047 [σ²=0.0958, R̂=1.0327]] 72%|███████▏  | 36/50 [02:28<01:53,  8.14s/it, Energy=-65.0517-0.0001j ± 0.0047 [σ²=0.0958, R̂=1.0327]]WARNING:absl:[process=0][thread=async_save_12] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/36.orbax-checkpoint-tmp-48/loggers.orbax-checkpoint-tmp-52, 
 72%|███████▏  | 36/50 [02:41<01:53,  8.14s/it, Energy=-65.0469-0.0001j ± 0.0058 [σ²=0.1409, R̂=1.0330]] 74%|███████▍  | 37/50 [02:41<01:58,  9.14s/it, Energy=-65.0469-0.0001j ± 0.0058 [σ²=0.1409, R̂=1.0330]]WARNING:absl:[process=0][thread=async_save_13] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/37.orbax-checkpoint-tmp-56/loggers.orbax-checkpoint-tmp-60, 
 74%|███████▍  | 37/50 [02:54<01:58,  9.14s/it, Energy=-65.0574+0.0004j ± 0.0033 [σ²=0.0499, R̂=1.0240]] 76%|███████▌  | 38/50 [02:54<02:00, 10.01s/it, Energy=-65.0574+0.0004j ± 0.0033 [σ²=0.0499, R̂=1.0240]]WARNING:absl:[process=0][thread=async_save_14] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/38.orbax-checkpoint-tmp-64/loggers.orbax-checkpoint-tmp-68, 
 76%|███████▌  | 38/50 [03:07<02:00, 10.01s/it, Energy=-65.0436-0.0005j ± 0.0048 [σ²=0.0974, R̂=1.0298]] 78%|███████▊  | 39/50 [03:07<01:58, 10.73s/it, Energy=-65.0436-0.0005j ± 0.0048 [σ²=0.0974, R̂=1.0298]]WARNING:absl:[process=0][thread=async_save_15] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/39.orbax-checkpoint-tmp-72/loggers.orbax-checkpoint-tmp-76, 
 78%|███████▊  | 39/50 [03:19<01:58, 10.73s/it, Energy=-65.0481-0.0000j ± 0.0034 [σ²=0.0612, R̂=1.0161]] 80%|████████  | 40/50 [03:19<01:53, 11.31s/it, Energy=-65.0481-0.0000j ± 0.0034 [σ²=0.0612, R̂=1.0161]]WARNING:absl:[process=0][thread=async_save_16] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/40.orbax-checkpoint-tmp-80/loggers.orbax-checkpoint-tmp-84, 
 80%|████████  | 40/50 [03:32<01:53, 11.31s/it, Energy=-65.0612+0.0006j ± 0.0084 [σ²=0.2980, R̂=1.0310]] 82%|████████▏ | 41/50 [03:32<01:45, 11.75s/it, Energy=-65.0612+0.0006j ± 0.0084 [σ²=0.2980, R̂=1.0310]]WARNING:absl:[process=0][thread=async_save_17] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/41.orbax-checkpoint-tmp-88/loggers.orbax-checkpoint-tmp-92, 
 82%|████████▏ | 41/50 [03:45<01:45, 11.75s/it, Energy=-65.0495+0.0004j ± 0.0042 [σ²=0.0748, R̂=1.0258]] 84%|████████▍ | 42/50 [03:45<01:36, 12.08s/it, Energy=-65.0495+0.0004j ± 0.0042 [σ²=0.0748, R̂=1.0258]]WARNING:absl:[process=0][thread=async_save_18] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/42.orbax-checkpoint-tmp-96/loggers.orbax-checkpoint-tmp-100, 
 84%|████████▍ | 42/50 [03:58<01:36, 12.08s/it, Energy=-65.0496-0.0003j ± 0.0044 [σ²=0.0664, R̂=1.0349]] 86%|████████▌ | 43/50 [03:58<01:26, 12.32s/it, Energy=-65.0496-0.0003j ± 0.0044 [σ²=0.0664, R̂=1.0349]]WARNING:absl:[process=0][thread=async_save_19] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/43.orbax-checkpoint-tmp-104/loggers.orbax-checkpoint-tmp-108, 
 86%|████████▌ | 43/50 [04:11<01:26, 12.32s/it, Energy=-65.0470+0.0011j ± 0.0039 [σ²=0.0673, R̂=1.0312]] 88%|████████▊ | 44/50 [04:11<01:14, 12.50s/it, Energy=-65.0470+0.0011j ± 0.0039 [σ²=0.0673, R̂=1.0312]]WARNING:absl:[process=0][thread=async_save_20] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/44.orbax-checkpoint-tmp-112/loggers.orbax-checkpoint-tmp-116, 
 88%|████████▊ | 44/50 [04:24<01:14, 12.50s/it, Energy=-65.0492-0.0000j ± 0.0035 [σ²=0.0496, R̂=1.0273]] 90%|█████████ | 45/50 [04:24<01:03, 12.63s/it, Energy=-65.0492-0.0000j ± 0.0035 [σ²=0.0496, R̂=1.0273]]WARNING:absl:[process=0][thread=async_save_21] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/45.orbax-checkpoint-tmp-120/loggers.orbax-checkpoint-tmp-124, 
 90%|█████████ | 45/50 [04:37<01:03, 12.63s/it, Energy=-65.0571+0.0008j ± 0.0051 [σ²=0.1041, R̂=1.0273]] 92%|█████████▏| 46/50 [04:37<00:50, 12.72s/it, Energy=-65.0571+0.0008j ± 0.0051 [σ²=0.1041, R̂=1.0273]]WARNING:absl:[process=0][thread=async_save_22] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/46.orbax-checkpoint-tmp-128/loggers.orbax-checkpoint-tmp-132, 
 92%|█████████▏| 46/50 [04:50<00:50, 12.72s/it, Energy=-65.0438-0.0001j ± 0.0040 [σ²=0.0636, R̂=1.0338]] 94%|█████████▍| 47/50 [04:50<00:38, 12.79s/it, Energy=-65.0438-0.0001j ± 0.0040 [σ²=0.0636, R̂=1.0338]]WARNING:absl:[process=0][thread=async_save_23] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/47.orbax-checkpoint-tmp-136/loggers.orbax-checkpoint-tmp-140, 
 94%|█████████▍| 47/50 [05:03<00:38, 12.79s/it, Energy=-65.0469+0.0002j ± 0.0042 [σ²=0.0758, R̂=1.0289]] 96%|█████████▌| 48/50 [05:03<00:25, 12.83s/it, Energy=-65.0469+0.0002j ± 0.0042 [σ²=0.0758, R̂=1.0289]]WARNING:absl:[process=0][thread=async_save_24] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/48.orbax-checkpoint-tmp-144/loggers.orbax-checkpoint-tmp-148, 
 96%|█████████▌| 48/50 [05:16<00:25, 12.83s/it, Energy=-65.0437+0.0006j ± 0.0044 [σ²=0.0737, R̂=1.0343]] 98%|█████████▊| 49/50 [05:16<00:12, 12.86s/it, Energy=-65.0437+0.0006j ± 0.0044 [σ²=0.0737, R̂=1.0343]]WARNING:absl:[process=0][thread=async_save_25] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/49.orbax-checkpoint-tmp-152/loggers.orbax-checkpoint-tmp-156, 
WARNING:absl:[process=0][thread=async_save_26] Skipping merge of OCDBT checkpoints: No per-process OCDBT checkpoint subdirs found in /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/post/checkpoint/50.orbax-checkpoint-tmp-160/loggers.orbax-checkpoint-tmp-164, 
100%|██████████| 50/50 [05:18<00:00,  6.37s/it, Energy=-65.0437+0.0006j ± 0.0044 [σ²=0.0737, R̂=1.0343]]
Final 50 energies = [-65.04873856 -65.04609855 -65.0507665  -65.05592956 -65.04788171
 -65.04223406 -65.05144257 -65.04975719 -65.04473169 -65.04729586
 -65.04781148 -65.0574056  -65.04173811 -65.04542267 -65.04019102
 -65.04936582 -65.04470994 -65.05021114 -65.04921915 -65.04612826
 -65.04274075 -65.0511969  -65.05780843 -65.04558159 -65.05249231
 -65.05288703 -65.0427305  -65.05223167 -65.04181503 -65.05277307
 -65.04182822 -65.04928556 -65.05102407 -65.04374506 -65.04668779
 -65.0546556  -65.05169147 -65.04691864 -65.05738098 -65.04355471
 -65.04810197 -65.0612325  -65.04947128 -65.049596   -65.04701178
 -65.04920222 -65.05713583 -65.04383361 -65.04687284 -65.04371673]
min_index=41
Finished additional optimization steps
Post-process time = 367s
Saving simulation results to /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/4/opt.log
Finished on process 0
