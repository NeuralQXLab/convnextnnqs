Job running on nodes: jean-zay-iam14
recursion 1 started at Mon Nov  4 01:45:50 AM CET 2024
WARNING: The directory '/.cache/pip' or its parent directory is not owned or is not writable by the current user. The cache has been disabled. Check the permissions and owner of that directory. If executing pip with sudo, you should use sudo's -H flag.
python -u -O /lustre/fswork/projects/rech/iqu/uvm91ap/repos/netket_pro_nocallback/deepnets/optimization/run.py --L=6 --J 0.8 1.0 --n_blocks 12 --features 72 --expansion_factor=2 --downsample_factor=2 --kernel_width=3 --output_head=Vanilla --samples_per_rank=512 --chains_per_rank=512 --discard_fraction=0.0 --iters 2500 2500 2500 2500 --lr 0.01 0.01 0.01 0.01 --alpha 0.5 0.5 0.5 0.5 --diag_shift 0.01 0.01 0.01 0.01 --diag_shift_end 0.0001 0.0001 0.0001 0.0001 --r=1e-06 --chunk_size=256 --save_every=100 --symmetries=0 --symmetry_ramping=1 --momentum=0.9 --post_iters=50 --double_precision=1 --time_it=0 --show_progress=0 --checkpoint=1 --seed=78  --save_base /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/8/ >> /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/8/${SLURM_JOB_ID}.out &
Configuring sharding...
Number of distributed processes = 1
Number of total devices: 8
0/1 : global [CudaDevice(id=0), CudaDevice(id=1), CudaDevice(id=2), CudaDevice(id=3), CudaDevice(id=4), CudaDevice(id=5), CudaDevice(id=6), CudaDevice(id=7)]
0/1 : local [CudaDevice(id=0), CudaDevice(id=1), CudaDevice(id=2), CudaDevice(id=3), CudaDevice(id=4), CudaDevice(id=5), CudaDevice(id=6), CudaDevice(id=7)]
0/1 : hostname:  jean-zay-iam14
Double precision enabled =  True
chunk_size = 256
Running optimization...
Symmetry stage 0 on process 0:
Total number of model parameters = 276552
Using minSR
restoring checkpoint #2500
restoring checkpoint #2500
Symmetry stage 1 on process 0:
Total number of model parameters = 276552
Using minSR
restoring checkpoint #2500
Symmetry stage 2 on process 0:
Total number of model parameters = 276552
Using minSR
restoring checkpoint #2500
Symmetry stage 3 on process 0:
Total number of model parameters = 276552
Using minSR
restoring checkpoint #2500
Finished optimization
Performing 50 additional optimization steps...
Sampling parameters:
n_chains = 256
n_samples = 4096
n_samples_per_chain = 16
n_discard_per_chain = 16
restoring checkpoint #50
  0%|          | 0/50 [00:00<?, ?it/s]  0%|          | 0/50 [01:18<?, ?it/s, Energy=-65.0484-0.0005j ± 0.0033 [σ²=0.0482, R̂=1.0299]]100%|██████████| 50/50 [01:18<00:00,  1.57s/it, Energy=-65.0484-0.0005j ± 0.0033 [σ²=0.0482, R̂=1.0299]]100%|██████████| 50/50 [01:18<00:00,  1.57s/it, Energy=-65.0484-0.0005j ± 0.0033 [σ²=0.0482, R̂=1.0299]]
Final 50 energies = [-65.05097441 -65.04735958 -65.05348795 -65.05594277 -65.06138389
 -65.04781686 -65.04599693 -65.05405305 -65.04789966 -65.04070555
 -65.04868392 -65.04281769 -65.04229733 -65.04549555 -65.05213351
 -65.04457484 -65.05511153 -65.04566686 -65.05016884 -65.04695525
 -65.04082865 -65.05458189 -65.04801831 -65.0446586  -65.04562286
 -65.0642711  -65.04896522 -65.03872861 -65.04210354 -65.03961373
 -65.05875033 -65.04704039 -65.04440827 -65.05050154 -65.05349339
 -65.04978784 -65.03844168 -65.03312198 -65.04889094 -65.04192158
 -65.04834483 -65.04502612 -65.04633075 -65.05051053 -65.04628017
 -65.04354939 -65.039709   -65.04698377 -65.04224516 -65.04839054]
min_index=25
Finished additional optimization steps
Post-process time = 80s
Saving simulation results to /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/8/opt.log
Finished on process 0
