Job running on nodes: jean-zay-iam47
recursion  started at Sat Nov  2 12:26:47 AM CET 2024
python -u -O /lustre/fswork/projects/rech/iqu/uvm91ap/repos/netket_pro_nocallback/deepnets/optimization/run.py --L=6 --J 0.8 1.0 --n_blocks 12 --features 72 --expansion_factor=2 --downsample_factor=2 --kernel_width=3 --output_head=Vanilla --samples_per_rank=512 --chains_per_rank=512 --discard_fraction=0.0 --iters 2500 2500 2500 2500 --lr 0.01 0.01 0.01 0.01 --alpha 0.5 0.5 0.5 0.5 --diag_shift 0.01 0.01 0.01 0.01 --diag_shift_end 0.0001 0.0001 0.0001 0.0001 --r=1e-06 --chunk_size=256 --save_every=100 --symmetries=0 --symmetry_ramping=1 --momentum=0.9 --post_iters=50 --double_precision=1 --time_it=0 --show_progress=0 --checkpoint=1 --seed=76  --save_base /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/5/ >> /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/5/${SLURM_JOB_ID}.out &
Configuring sharding...
Number of distributed processes = 1
Number of total devices: 8
0/1 : global [CudaDevice(id=0), CudaDevice(id=1), CudaDevice(id=2), CudaDevice(id=3), CudaDevice(id=4), CudaDevice(id=5), CudaDevice(id=6), CudaDevice(id=7)]
0/1 : local [CudaDevice(id=0), CudaDevice(id=1), CudaDevice(id=2), CudaDevice(id=3), CudaDevice(id=4), CudaDevice(id=5), CudaDevice(id=6), CudaDevice(id=7)]
0/1 : hostname:  jean-zay-iam47
Double precision enabled =  True
chunk_size = 256
Running optimization...
Symmetry stage 0 on process 0:
Total number of model parameters = 276552
Using minSR
restoring checkpoint #2500
restoring checkpoint #2500
Symmetry stage 1 on process 0:
Total number of model parameters = 276552
Using minSR
restoring checkpoint #2500
Symmetry stage 2 on process 0:
Total number of model parameters = 276552
Using minSR
restoring checkpoint #2500
Symmetry stage 3 on process 0:
Total number of model parameters = 276552
Using minSR
restoring checkpoint #2500
Finished optimization
Performing 50 additional optimization steps...
Sampling parameters:
n_chains = 256
n_samples = 4096
n_samples_per_chain = 16
n_discard_per_chain = 16
restoring checkpoint #50
  0%|          | 0/50 [00:00<?, ?it/s]  0%|          | 0/50 [01:17<?, ?it/s, Energy=-65.0514+0.0003j ± 0.0036 [σ²=0.0563, R̂=1.0314]]100%|██████████| 50/50 [01:17<00:00,  1.55s/it, Energy=-65.0514+0.0003j ± 0.0036 [σ²=0.0563, R̂=1.0314]]100%|██████████| 50/50 [01:17<00:00,  1.55s/it, Energy=-65.0514+0.0003j ± 0.0036 [σ²=0.0563, R̂=1.0314]]
Final 50 energies = [-65.07236356 -65.04843355 -65.03911459 -65.05157209 -65.05303826
 -65.0435827  -65.05038214 -65.05355613 -65.05434396 -65.05076179
 -65.04815582 -65.04877505 -65.04999151 -65.04697582 -65.05700022
 -65.05831717 -65.05112974 -65.04888528 -65.04486373 -65.04580776
 -65.04638489 -65.04937526 -65.04636472 -65.05763329 -65.05005936
 -65.04875164 -65.0460248  -65.04704354 -65.05271817 -65.05015304
 -65.04053215 -65.0467588  -65.04656977 -65.03991287 -65.04272198
 -65.05293636 -65.04591104 -65.05110161 -65.052022   -65.05085492
 -65.0502687  -65.04938472 -65.04896463 -65.04421349 -65.04600671
 -65.04735945 -65.04281133 -65.04677149 -65.04621877 -65.05136161]
min_index=0
Finished additional optimization steps
Post-process time = 79s
Saving simulation results to /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/5/opt.log
Finished on process 0
