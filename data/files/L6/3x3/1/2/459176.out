Job running on nodes: jean-zay-iam47
recursion  started at Sat Nov  2 12:00:00 AM CET 2024
python -u -O /lustre/fswork/projects/rech/iqu/uvm91ap/repos/netket_pro_nocallback/deepnets/optimization/run.py --L=6 --J 0.8 1.0 --n_blocks 12 --features 72 --expansion_factor=2 --downsample_factor=2 --kernel_width=3 --output_head=Vanilla --samples_per_rank=512 --chains_per_rank=512 --discard_fraction=0.0 --iters 2500 2500 2500 2500 --lr 0.01 0.01 0.01 0.01 --alpha 0.5 0.5 0.5 0.5 --diag_shift 0.01 0.01 0.01 0.01 --diag_shift_end 0.0001 0.0001 0.0001 0.0001 --r=1e-06 --chunk_size=256 --save_every=100 --symmetries=0 --symmetry_ramping=1 --momentum=0.9 --post_iters=50 --double_precision=1 --time_it=0 --show_progress=0 --checkpoint=1 --seed=75  --save_base /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/2/ >> /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/2/${SLURM_JOB_ID}.out &
Configuring sharding...
Number of distributed processes = 1
Number of total devices: 8
0/1 : global [CudaDevice(id=0), CudaDevice(id=1), CudaDevice(id=2), CudaDevice(id=3), CudaDevice(id=4), CudaDevice(id=5), CudaDevice(id=6), CudaDevice(id=7)]
0/1 : local [CudaDevice(id=0), CudaDevice(id=1), CudaDevice(id=2), CudaDevice(id=3), CudaDevice(id=4), CudaDevice(id=5), CudaDevice(id=6), CudaDevice(id=7)]
0/1 : hostname:  jean-zay-iam47
Double precision enabled =  True
chunk_size = 256
Running optimization...
Symmetry stage 0 on process 0:
Total number of model parameters = 276552
Using minSR
restoring checkpoint #2500
restoring checkpoint #2500
Symmetry stage 1 on process 0:
Total number of model parameters = 276552
Using minSR
restoring checkpoint #2500
Symmetry stage 2 on process 0:
Total number of model parameters = 276552
Using minSR
restoring checkpoint #2500
Symmetry stage 3 on process 0:
Total number of model parameters = 276552
Using minSR
restoring checkpoint #2500
Finished optimization
Performing 50 additional optimization steps...
Sampling parameters:
n_chains = 256
n_samples = 4096
n_samples_per_chain = 16
n_discard_per_chain = 16
restoring checkpoint #50
  0%|          | 0/50 [00:00<?, ?it/s]  0%|          | 0/50 [01:19<?, ?it/s, Energy=-65.0475-0.0009j ± 0.0034 [σ²=0.0511, R̂=1.0284]]100%|██████████| 50/50 [01:19<00:00,  1.58s/it, Energy=-65.0475-0.0009j ± 0.0034 [σ²=0.0511, R̂=1.0284]]100%|██████████| 50/50 [01:19<00:00,  1.58s/it, Energy=-65.0475-0.0009j ± 0.0034 [σ²=0.0511, R̂=1.0284]]
Final 50 energies = [-65.04211027 -65.03921926 -65.04349253 -65.05138286 -65.04593217
 -65.05147636 -65.04839467 -65.04449632 -65.05017335 -65.04612272
 -65.05646948 -65.03854037 -65.04478092 -65.04096319 -65.05087161
 -65.05458982 -65.05189335 -65.04262763 -65.05285685 -65.04360578
 -65.04999742 -65.0425545  -65.04072735 -65.05560713 -65.05212893
 -65.05581198 -65.05236315 -65.04854962 -65.0578697  -65.04771819
 -65.04518502 -65.041848   -65.04493613 -65.05586365 -65.04459412
 -65.05160759 -65.05353873 -65.05358184 -65.04954561 -65.04325021
 -65.04058707 -65.0451817  -65.04566335 -65.05122683 -65.04052226
 -65.04565182 -65.04497648 -65.04758724 -65.04071601 -65.04749693]
min_index=28
Finished additional optimization steps
Post-process time = 81s
Saving simulation results to /gpfswork/rech/iqu/uvm91ap/projects/deepNQS/ConvNext/14_10_24/L=6/symm_ramp_3x3/2/opt.log
Finished on process 0
