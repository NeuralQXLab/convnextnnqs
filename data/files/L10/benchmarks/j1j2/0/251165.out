Job running on nodes: jean-zay-iam36
Resolved 60 packages in 88ms
Configuring sharding...
Number of distributed processes = 1
Number of total devices: 8
0/1 : global [CudaDevice(id=0), CudaDevice(id=1), CudaDevice(id=2), CudaDevice(id=3), CudaDevice(id=4), CudaDevice(id=5), CudaDevice(id=6), CudaDevice(id=7)]
0/1 : local [CudaDevice(id=0), CudaDevice(id=1), CudaDevice(id=2), CudaDevice(id=3), CudaDevice(id=4), CudaDevice(id=5), CudaDevice(id=6), CudaDevice(id=7)]
0/1 : hostname:  jean-zay-iam36
args_setup: Namespace(config='/lustre/fswork/projects/rech/rgs/uvm91ap/projects/deepNQS/ConvNext/30_01_25/J1J2_L10_benchmark_run/0/config.yaml', system='Square_Heisenberg', network='ConvNext')
args: Namespace(config=None, system=None, network=None, L=10, J=[1.0, 0.5], sign_rule=[0, 0], patching=1, n_blocks=[6], features=[72], expansion_factor=3, net_type='Vanilla', kernel_width=3, downsample_factor=2, final_features=144, init_kernel_width=1, output_depth=2, samples_per_rank=512, n_chains_per_rank=512, discard_fraction=0.0, iters=[2500, 2500, 1000, 200, 100], lr=[0.01, 0.01, 0.01, 0.01, 0.01], diag_shift=[0.01, 0.01, 0.01, 0.01, 0.01], diag_shift_factor=[0.0001, 0.0001, 0.0001, 0.0001, 0.0001], r=1e-06, save_base='', save_num=0, seed=6228, time_it=0, show_progress=1, chunk_size=256, lr_factor=[0.5, 0.5, 0.5, 0.5, 0.5], save_every=100, symmetries=0, symmetry_ramping=1, momentum=0.9, checkpoint=1, post_iters=50, sweep_factor=4, double_precision=1)
Double precision enabled =  True
Using net_type=Vanilla
Number of symmetry stages = 5
Maximum no. of parameters = 260568, total number of samples = 4096
Using minSR = True
Running optimization...
Symmetry stage 0/4 on process 0:
Compiling...
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:41<?, ?it/s, Energy=28.88-1.18j ± 0.64 [σ²=1701.81]]100%|██████████| 1/1 [00:00<00:00,  2.48it/s, Energy=28.88-1.18j ± 0.64 [σ²=1701.81]]100%|██████████| 1/1 [00:00<00:00,  2.48it/s, Energy=28.88-1.18j ± 0.64 [σ²=1701.81]]
Compilation time = 42s
Running optimization...
restoring checkpoint #2500
  0%|          | 0/2500 [00:00<?, ?it/s]  0%|          | 0/2500 [00:01<?, ?it/s, Energy=-198.646-0.003j ± 0.035 [σ²=5.008]]100%|█████████▉| 2499/2500 [00:01<00:00, 1806.26it/s, Energy=-198.646-0.003j ± 0.035 [σ²=5.008]]100%|█████████▉| 2499/2500 [00:18<00:00, 1806.26it/s, Energy=-198.646-0.003j ± 0.035 [σ²=5.008]]100%|█████████▉| 2499/2500 [00:28<00:00, 1806.26it/s, Energy=-198.646-0.003j ± 0.035 [σ²=5.008]]100%|██████████| 2500/2500 [00:01<00:00, 1779.13it/s, Energy=-198.646-0.003j ± 0.035 [σ²=5.008]]
Optimization time = 28s
Symmetry stage 1/4 on process 0:
Compiling...
  0%|          | 0/1 [00:00<?, ?it/s]  0%|          | 0/1 [00:54<?, ?it/s, Energy=-198.758-0.000j ± 0.032 [σ²=4.160]]100%|██████████| 1/1 [00:00<00:00,  2.27it/s, Energy=-198.758-0.000j ± 0.032 [σ²=4.160]]100%|██████████| 1/1 [00:00<00:00,  2.27it/s, Energy=-198.758-0.000j ± 0.032 [σ²=4.160]]
Compilation time = 54s
Running optimization...
restoring checkpoint #2500
  0%|          | 0/2500 [00:00<?, ?it/s]  0%|          | 0/2500 [00:01<?, ?it/s, Energy=-198.414+0.015j ± 0.035 [σ²=4.954]]100%|█████████▉| 2499/2500 [00:01<00:00, 2090.72it/s, Energy=-198.414+0.015j ± 0.035 [σ²=4.954]]100%|█████████▉| 2499/2500 [00:16<00:00, 2090.72it/s, Energy=-198.414+0.015j ± 0.035 [σ²=4.954]]100%|█████████▉| 2499/2500 [00:54<00:00, 2090.72it/s, Energy=-198.414+0.015j ± 0.035 [σ²=4.954]]100%|██████████| 2500/2500 [00:01<00:00, 2046.51it/s, Energy=-198.414+0.015j ± 0.035 [σ²=4.954]]
Optimization time = 54s
Symmetry stage 2/4 on process 0:
Compiling...
  0%|          | 0/1 [00:00<?, ?it/s]2025-02-04 13:08:50.680748: E external/xla/xla/service/slow_operation_alarm.cc:73] Trying algorithm eng20{k2=6,k3=0} for conv %cudnn-conv-bw-filter.30 = (f64[72,1,3,3]{3,2,1,0}, u8[0]{0}) custom-call(f64[4096,72,7,7]{3,2,1,0} %bitcast.55458, f64[4096,72,5,5]{3,2,1,0} %bitcast.56455), window={size=3x3}, dim_labels=bf01_oi01->bf01, feature_group_count=72, custom_call_target="__cudnn$convBackwardFilter", metadata={op_name="jit(SRt_ntk)/jit(main)/jit(shmap_body)/while/body/transpose(jvp(SymmExpSum))/module/encoder/stages_0/layers_0/Conv_0/conv_general_dilated" source_file="/lustre/fsn1/projects/rech/rgs/uvm91ap/uv_envs/nk_pro_update/.venv/lib/python3.12/site-packages/flax/linen/linear.py" source_line=658}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2025-02-04 13:08:50.709753: E external/xla/xla/service/slow_operation_alarm.cc:140] The operation took 1.029102168s
Trying algorithm eng20{k2=6,k3=0} for conv %cudnn-conv-bw-filter.30 = (f64[72,1,3,3]{3,2,1,0}, u8[0]{0}) custom-call(f64[4096,72,7,7]{3,2,1,0} %bitcast.55458, f64[4096,72,5,5]{3,2,1,0} %bitcast.56455), window={size=3x3}, dim_labels=bf01_oi01->bf01, feature_group_count=72, custom_call_target="__cudnn$convBackwardFilter", metadata={op_name="jit(SRt_ntk)/jit(main)/jit(shmap_body)/while/body/transpose(jvp(SymmExpSum))/module/encoder/stages_0/layers_0/Conv_0/conv_general_dilated" source_file="/lustre/fsn1/projects/rech/rgs/uvm91ap/uv_envs/nk_pro_update/.venv/lib/python3.12/site-packages/flax/linen/linear.py" source_line=658}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
  0%|          | 0/1 [02:05<?, ?it/s, Energy=-30.5-17.9j ± 57.5 [σ²=13550504.2]]100%|██████████| 1/1 [00:00<00:00,  2.03it/s, Energy=-30.5-17.9j ± 57.5 [σ²=13550504.2]]100%|██████████| 1/1 [00:00<00:00,  2.03it/s, Energy=-30.5-17.9j ± 57.5 [σ²=13550504.2]]
Compilation time = 126s
Running optimization...
restoring checkpoint #1
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 0/1000 [00:00<?, ?it/s, Energy=nan+nanj ± nan [σ²=nan]]  0%|          | 0/1000 [00:00<?, ?it/s, Energy=nan+nanj ± nan [σ²=nan]]  0%|          | 0/1000 [01:58<?, ?it/s, Energy=nan+nanj ± nan [σ²=nan]]  0%|          | 0/1000 [00:00<?, ?it/s, Energy=nan+nanj ± nan [σ²=nan]]
Optimization time = 118s
Symmetry stage 3/4 on process 0:
Compiling...
  0%|          | 0/1 [00:00<?, ?it/s]2025-02-04 13:14:23.273147: E external/xla/xla/service/slow_operation_alarm.cc:73] Trying algorithm eng20{k2=6,k3=0} for conv %cudnn-conv-bw-filter.30 = (f64[72,1,3,3]{3,2,1,0}, u8[0]{0}) custom-call(f64[8192,72,7,7]{3,2,1,0} %bitcast.55492, f64[8192,72,5,5]{3,2,1,0} %bitcast.56613), window={size=3x3}, dim_labels=bf01_oi01->bf01, feature_group_count=72, custom_call_target="__cudnn$convBackwardFilter", metadata={op_name="jit(SRt_ntk)/jit(main)/jit(shmap_body)/while/body/transpose(jvp(SymmExpSum))/module/encoder/stages_0/layers_0/Conv_0/conv_general_dilated" source_file="/lustre/fsn1/projects/rech/rgs/uvm91ap/uv_envs/nk_pro_update/.venv/lib/python3.12/site-packages/flax/linen/linear.py" source_line=658}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
2025-02-04 13:14:25.225681: E external/xla/xla/service/slow_operation_alarm.cc:140] The operation took 2.952589515s
Trying algorithm eng20{k2=6,k3=0} for conv %cudnn-conv-bw-filter.30 = (f64[72,1,3,3]{3,2,1,0}, u8[0]{0}) custom-call(f64[8192,72,7,7]{3,2,1,0} %bitcast.55492, f64[8192,72,5,5]{3,2,1,0} %bitcast.56613), window={size=3x3}, dim_labels=bf01_oi01->bf01, feature_group_count=72, custom_call_target="__cudnn$convBackwardFilter", metadata={op_name="jit(SRt_ntk)/jit(main)/jit(shmap_body)/while/body/transpose(jvp(SymmExpSum))/module/encoder/stages_0/layers_0/Conv_0/conv_general_dilated" source_file="/lustre/fsn1/projects/rech/rgs/uvm91ap/uv_envs/nk_pro_update/.venv/lib/python3.12/site-packages/flax/linen/linear.py" source_line=658}, backend_config={"operation_queue_id":"0","wait_on_operation_queues":[],"cudnn_conv_backend_config":{"conv_result_scale":1,"activation_mode":"kNone","side_input_scale":0,"leakyrelu_alpha":0},"force_earliest_schedule":false} is taking a while...
  0%|          | 0/1 [03:28<?, ?it/s, Energy=nan+nanj ± nan [σ²=nan]]  0%|          | 0/1 [03:28<?, ?it/s, Energy=nan+nanj ± nan [σ²=nan]]  0%|          | 0/1 [03:28<?, ?it/s, Energy=nan+nanj ± nan [σ²=nan]]
Compilation time = 208s
Running optimization...
restoring checkpoint #0
  0%|          | 0/200 [00:00<?, ?it/s]  0%|          | 0/200 [03:25<?, ?it/s, Energy=nan+nanj ± nan [σ²=nan]]  0%|          | 0/200 [03:25<?, ?it/s, Energy=nan+nanj ± nan [σ²=nan]]  0%|          | 0/200 [06:25<?, ?it/s, Energy=nan+nanj ± nan [σ²=nan]]  0%|          | 0/200 [03:25<?, ?it/s, Energy=nan+nanj ± nan [σ²=nan]]
Optimization time = 386s
Symmetry stage 4/4 on process 0:
Compiling...
  0%|          | 0/1 [00:00<?, ?it/s]2025-02-04 13:27:57.320105: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_6_bfc) ran out of memory trying to allocate 59.95GiB (rounded to 64368559104)requested by op 
2025-02-04 13:27:57.320479: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *___________________________________________________________________________________________________
E0204 13:27:57.320539   35917 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 64368559008 bytes.
2025-02-04 13:27:57.322198: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_3_bfc) ran out of memory trying to allocate 59.95GiB (rounded to 64368559104)requested by op 
2025-02-04 13:27:57.322526: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *___________________________________________________________________________________________________
E0204 13:27:57.322575   35908 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 64368559008 bytes.
2025-02-04 13:27:57.324526: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_0_bfc) ran out of memory trying to allocate 59.95GiB (rounded to 64368559104)requested by op 
2025-02-04 13:27:57.324971: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *___________________________________________________________________________________________________
E0204 13:27:57.325022   35899 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 64368559008 bytes.
2025-02-04 13:27:57.326781: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_2_bfc) ran out of memory trying to allocate 59.95GiB (rounded to 64368559104)requested by op 
2025-02-04 13:27:57.327159: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *___________________________________________________________________________________________________
E0204 13:27:57.327233   35905 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 64368559008 bytes.
2025-02-04 13:27:57.328908: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_5_bfc) ran out of memory trying to allocate 59.95GiB (rounded to 64368559104)requested by op 
2025-02-04 13:27:57.329302: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *___________________________________________________________________________________________________
E0204 13:27:57.329378   35914 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 64368559008 bytes.
2025-02-04 13:27:57.330872: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_1_bfc) ran out of memory trying to allocate 59.95GiB (rounded to 64368559104)requested by op 
2025-02-04 13:27:57.331253: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *___________________________________________________________________________________________________
E0204 13:27:57.331320   35902 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 64368559008 bytes.
2025-02-04 13:27:57.333065: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_4_bfc) ran out of memory trying to allocate 59.95GiB (rounded to 64368559104)requested by op 
2025-02-04 13:27:57.333445: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *___________________________________________________________________________________________________
E0204 13:27:57.333514   35911 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 64368559008 bytes.
2025-02-04 13:27:57.335181: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_7_bfc) ran out of memory trying to allocate 59.95GiB (rounded to 64368559104)requested by op 
2025-02-04 13:27:57.335560: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *___________________________________________________________________________________________________
E0204 13:27:57.335627   35920 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 64368559008 bytes.
  0%|          | 0/1 [06:32<?, ?it/s]
Out of memory, reducing chunk_size to 128 and retrying
Compiling...
  0%|          | 0/1 [00:00<?, ?it/s]2025-02-04 13:34:49.288584: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_3_bfc) ran out of memory trying to allocate 2.01GiB (rounded to 2156070656)requested by op 
2025-02-04 13:34:49.288659: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_6_bfc) ran out of memory trying to allocate 2.01GiB (rounded to 2156070656)requested by op 
2025-02-04 13:34:49.288748: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_0_bfc) ran out of memory trying to allocate 2.01GiB (rounded to 2156070656)requested by op 
2025-02-04 13:34:49.288818: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_1_bfc) ran out of memory trying to allocate 2.01GiB (rounded to 2156070656)requested by op 
2025-02-04 13:34:49.288883: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_5_bfc) ran out of memory trying to allocate 2.01GiB (rounded to 2156070656)requested by op 
2025-02-04 13:34:49.288970: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_4_bfc) ran out of memory trying to allocate 2.01GiB (rounded to 2156070656)requested by op 
2025-02-04 13:34:49.289026: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_2_bfc) ran out of memory trying to allocate 2.01GiB (rounded to 2156070656)requested by op 
2025-02-04 13:34:49.289096: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_7_bfc) ran out of memory trying to allocate 2.01GiB (rounded to 2156070656)requested by op 
2025-02-04 13:34:49.289152: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *************************************************************************************************___
2025-02-04 13:34:49.289179: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *************************************************************************************************___
2025-02-04 13:34:49.289203: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *************************************************************************************************___
2025-02-04 13:34:49.289228: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *************************************************************************************************___
2025-02-04 13:34:49.289283: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *************************************************************************************************___
2025-02-04 13:34:49.289319: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *************************************************************************************************___
2025-02-04 13:34:49.289400: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *************************************************************************************************___
2025-02-04 13:34:49.289434: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *************************************************************************************************___
E0204 13:34:49.289998   35917 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Unable to allocate device workspace for syevd
E0204 13:34:49.290095   35899 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Unable to allocate device workspace for syevd
E0204 13:34:49.290210   35914 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Unable to allocate device workspace for syevd
E0204 13:34:49.290338   35911 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Unable to allocate device workspace for syevd
E0204 13:34:49.290410   35905 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Unable to allocate device workspace for syevd
E0204 13:34:49.290460   35902 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Unable to allocate device workspace for syevd
E0204 13:34:49.290469   35908 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Unable to allocate device workspace for syevd
E0204 13:34:49.290481   35920 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Unable to allocate device workspace for syevd
  0%|          | 0/1 [06:50<?, ?it/s]
Out of memory, reducing chunk_size to 64 and retrying
Compiling...
  0%|          | 0/1 [00:00<?, ?it/s]2025-02-04 13:35:07.366312: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_4_bfc) ran out of memory trying to allocate 42.19GiB (rounded to 45298495744)requested by op 
2025-02-04 13:35:07.366400: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_7_bfc) ran out of memory trying to allocate 42.19GiB (rounded to 45298495744)requested by op 
2025-02-04 13:35:07.366471: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_6_bfc) ran out of memory trying to allocate 42.19GiB (rounded to 45298495744)requested by op 
2025-02-04 13:35:07.366561: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_3_bfc) ran out of memory trying to allocate 42.19GiB (rounded to 45298495744)requested by op 
2025-02-04 13:35:07.366637: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_0_bfc) ran out of memory trying to allocate 42.19GiB (rounded to 45298495744)requested by op 
2025-02-04 13:35:07.366743: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *************************************************************************************************___
E0204 13:35:07.366804   35911 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45298495552 bytes.
2025-02-04 13:35:07.366785: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_5_bfc) ran out of memory trying to allocate 42.19GiB (rounded to 45298495744)requested by op 
2025-02-04 13:35:07.366868: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_1_bfc) ran out of memory trying to allocate 42.19GiB (rounded to 45298495744)requested by op 
2025-02-04 13:35:07.366945: W external/xla/xla/tsl/framework/bfc_allocator.cc:501] Allocator (GPU_2_bfc) ran out of memory trying to allocate 42.19GiB (rounded to 45298495744)requested by op 
2025-02-04 13:35:07.367030: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *************************************************************************************************___
2025-02-04 13:35:07.367062: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *************************************************************************************************___
E0204 13:35:07.367081   35920 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45298495552 bytes.
2025-02-04 13:35:07.367091: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *************************************************************************************************___
2025-02-04 13:35:07.367122: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *************************************************************************************************___
2025-02-04 13:35:07.367146: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *************************************************************************************************___
E0204 13:35:07.367137   35917 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45298495552 bytes.
E0204 13:35:07.367154   35899 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45298495552 bytes.
E0204 13:35:07.367164   35908 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45298495552 bytes.
E0204 13:35:07.367180   35902 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45298495552 bytes.
2025-02-04 13:35:07.367177: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *************************************************************************************************___
E0204 13:35:07.367259   35914 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45298495552 bytes.
2025-02-04 13:35:07.367350: W external/xla/xla/tsl/framework/bfc_allocator.cc:512] *************************************************************************************************___
E0204 13:35:07.367418   35905 pjrt_stream_executor_client.cc:3086] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45298495552 bytes.
  0%|          | 0/1 [00:10<?, ?it/s]
Traceback (most recent call last):
  File "/lustre/fswork/projects/rech/rgs/uvm91ap/repos/netket_pro_update/deepnets/scripts/../optimization/run.py", line 68, in <module>
    sim_time, n_parameters = protocol.run()
                             ^^^^^^^^^^^^^^
  File "/lustre/fswork/projects/rech/rgs/uvm91ap/repos/netket_pro_update/deepnets/optimization/protocols.py", line 561, in run
    sim_time, final_lr, final_diag_shift = self.optimize()
                                           ^^^^^^^^^^^^^^^
  File "/lustre/fswork/projects/rech/rgs/uvm91ap/repos/netket_pro_update/deepnets/optimization/protocols.py", line 482, in optimize
    driver.run(
  File "/lustre/fsn1/projects/rech/rgs/uvm91ap/uv_envs/nk_pro_update/.venv/lib/python3.12/site-packages/netket/driver/abstract_variational_driver.py", line 347, in run
    for step in self.iter(n_iter, step_size):
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/fswork/projects/rech/rgs/uvm91ap/repos/netket_pro_update/packages/netket_checkpoint/_src/driver1/abstract_variational_driver.py", line 70, in iter
    dp = self._forward_and_backward()
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/fswork/projects/rech/rgs/uvm91ap/repos/netket_pro_update/packages/netket_pro/_src/driver/vmc_srt_ntk.py", line 376, in _forward_and_backward
    local_energies = self.state.local_estimators(self._ham)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/fsn1/projects/rech/rgs/uvm91ap/uv_envs/nk_pro_update/.venv/lib/python3.12/site-packages/netket/utils/timing.py", line 276, in timed_function
    result = fun(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^
  File "/lustre/fsn1/projects/rech/rgs/uvm91ap/uv_envs/nk_pro_update/.venv/lib/python3.12/site-packages/netket/vqs/mc/mc_state/state.py", line 614, in local_estimators
    return local_estimators(self, op, chunk_size=chunk_size)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/fsn1/projects/rech/rgs/uvm91ap/uv_envs/nk_pro_update/.venv/lib/python3.12/site-packages/netket/vqs/mc/mc_state/state.py", line 782, in local_estimators
    s, extra_args = get_local_kernel_arguments(state, op)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/fsn1/projects/rech/rgs/uvm91ap/uv_envs/nk_pro_update/.venv/lib/python3.12/site-packages/plum/function.py", line 383, in __call__
    return _convert(method(*args, **kw_args), return_type)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/fsn1/projects/rech/rgs/uvm91ap/uv_envs/nk_pro_update/.venv/lib/python3.12/site-packages/netket/vqs/mc/mc_state/expect.py", line 75, in get_local_kernel_arguments
    σ = vstate.samples
        ^^^^^^^^^^^^^^
  File "/lustre/fswork/projects/rech/rgs/uvm91ap/repos/netket_pro_update/packages/netket_pro/_src/monkeypatch/mcstate_sampling.py", line 341, in samples
    return self.samples_distribution()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/fswork/projects/rech/rgs/uvm91ap/repos/netket_pro_update/packages/netket_pro/_src/monkeypatch/mcstate_sampling.py", line 274, in samples_distribution
    self.sample_distribution(
  File "/lustre/fswork/projects/rech/rgs/uvm91ap/repos/netket_pro_update/packages/netket_pro/_src/monkeypatch/mcstate_sampling.py", line 199, in sample_distribution
    sampler_state = self.sampler.reset(distribution, variables, sampler_state)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/lustre/fsn1/projects/rech/rgs/uvm91ap/uv_envs/nk_pro_update/.venv/lib/python3.12/site-packages/netket/sampler/base.py", line 265, in reset
    return sampler._reset(wrap_afun(machine), parameters, state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 45298495552 bytes.: while running replica 0 and partition 0 of a replicated computation (other replicas may have failed as well).
srun: error: jean-zay-iam36: task 0: Exited with exit code 1
srun: Terminating StepId=251165.0
